"use strict";define(["url","cookie","md5"],function(s,e){function t(){this.checkArr=[!1,!1,!1,!1]}return t.prototype.init=function(){""!=window.location.search&&$("#iframe").attr("src","/html/register.html")},t.prototype.check=function(){var e=this,t=/^1[3549][135497]\d{8}$/;$("#userName").on("blur",function(){e.checktext($(this),t,0)});var r=/^[a-zA-Z0-9_.-]+@[a-zA-Z0-9-]+(\.[a-zA-Z0-9-]+)*\.[a-zA-Z0-9]{2,6}$/;$("#userEmail").on("blur",function(){e.checktext($(this),r,1)});var n=/^[a-zA-Z]{3}\d{3}/;$("#userPwd").on("blur",function(){e.checktext($(this),n,2),""!=$("#oldPwd").val()&&($("#oldPwd").val()!=$(this).val()&&""!=$(this).val()?($("#oldPwd").parent().find("i").show().removeClass("succ"),e.checkArr[3]=!1):($("#oldPwd").parent().find("i").show().addClass("succ"),e.checkArr[3]=!0))}),$("#oldPwd").on("blur",function(){$(this).val()==$("#userPwd").val()&&""!=$("#userPwd").val()?($(this).parent().find("i").show().addClass("succ"),e.checkArr[3]=!0):($(this).parent().find("i").show().removeClass("succ"),e.checkArr[3]=!1)}),this.register()},t.prototype.checktext=function(e,t,r){var n=e.val();t.test(n)?(e.parent().find("i").show().addClass("succ"),this.checkArr[r]=!0):(e.parent().find("i").show().removeClass("succ"),this.checkArr[r]=!1)},t.prototype.register=function(){var i=this,c=!0;$("#register_btn").on("click",function(r){if($.each(i.checkArr,function(e,t){c=0!=t||(r.preventDefault(),!1)}),c){var e=$("#userName").val(),t=$("#userEmail").val(),n=hex_md5($("#userPwd").val());$.post(s.url+"/v1/userRegister.php",{userName:e,userEmail:t,userPwd:n},function(e){0==e.code?($("#hint").html("不能使用同一个电话号码只能绑定一个邮箱！"),r.preventDefault()):2==e.code?($("#hint").htmlt("注册失败！"),r.preventDefault()):1==e.code&&$("#hint").html("恭喜你注册成功！")},"json")}else $("#hint").html("请按规定注册账号！"),r.preventDefault()})},t.prototype.login=function(){$("#login_btn").on("click",function(){var t=$("#userName").val(),e=hex_md5($("#userPwd").val());$.get(s.url+"/v1/userLogin.php",{userName:t,userPwd:e},function(e){1!=e.code?$("#hint").html("请输入正确的用户名和密码！"):($.cookie("userTell",t,{path:"/"}),parent.location.href="/index.html")},"json")})},new t});